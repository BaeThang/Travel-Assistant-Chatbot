<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Travel Demo · Chatbot</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  <style>
    :root{
      --bg:#0f172a;          /* slate-900 */
      --card:#111827;        /* gray-900 */
      --muted:#94a3b8;       /* slate-400 */
      --text:#e5e7eb;        /* gray-200 */
      --brand:#22d3ee;       /* cyan-400 */
      --brand-2:#a78bfa;     /* violet-400 */
      --accent:#10b981;      /* emerald-500 */
      --danger:#ef4444;
      --ring: rgba(34,211,238,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text); background: radial-gradient(1200px 600px at 90% -10%, rgba(167,139,250,.25), transparent 60%), linear-gradient(180deg, #0b1220, #0f172a 30%);
    }
    a{color:var(--brand)}
    .container{max-width:1100px;margin:0 auto;padding:32px}

    /* Header */
    .nav{display:flex;align-items:center;justify-content:space-between;gap:16px}
    .logo{display:flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.3px}
    .logo-dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(45deg,var(--brand),var(--brand-2));box-shadow:0 0 16px var(--ring)}
    .nav a{opacity:.9;text-decoration:none}

    /* Hero */
    .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:32px;align-items:center;margin-top:36px}
    .hero h1{font-size:clamp(28px,4vw,44px);line-height:1.05;margin:0 0 12px}
    .hero p{color:var(--muted);font-size:clamp(14px,1.6vw,17px)}
    .cta{display:flex;gap:12px;margin-top:16px}
    .btn{padding:12px 16px;border-radius:14px;border:1px solid #1f2937;background:#131a2a;color:var(--text);cursor:pointer;transition:.2s ease;box-shadow:0 4px 18px rgba(0,0,0,.35)}
    .btn.primary{background:linear-gradient(90deg,var(--brand),var(--brand-2));border:none;color:#0b1220;font-weight:700}
    .btn:hover{transform:translateY(-1px);box-shadow:0 8px 28px rgba(0,0,0,.45)}

    /* Cards */
    .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-top:36px}
    .card{background:linear-gradient(180deg,#0f172a,#0b1220);border:1px solid #1f2937;border-radius:18px;overflow:hidden;box-shadow:inset 0 1px 0 rgba(255,255,255,.04), 0 10px 30px rgba(0,0,0,.35)}
    .card img{width:100%;height:160px;object-fit:cover}
    .card .inner{padding:14px}
    .pill{display:inline-flex;align-items:center;gap:6px;background:#0d1424;border:1px solid #1f2937;border-radius:999px;padding:6px 10px;color:var(--muted);font-size:12px}

    /* Footer */
    footer{border-top:1px solid #1f2937;margin-top:40px;padding:20px 0;color:var(--muted);font-size:14px}

    /* Chat widget */
    .chat-launcher{position:fixed;right:20px;bottom:20px;border:none;border-radius:999px;padding:14px 16px;background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#0b1220;font-weight:800;box-shadow:0 8px 28px rgba(0,0,0,.45);cursor:pointer;z-index:60}

    .chat-panel{position:fixed;right:20px;bottom:84px;width:360px;max-width:92vw;height:520px;display:flex;flex-direction:column;border-radius:16px;background:#0b1220;border:1px solid #1f2937;box-shadow:0 10px 40px rgba(0,0,0,.6);overflow:hidden;z-index:60}
    .hidden{display:none}
    .chat-header{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;background:linear-gradient(90deg, rgba(34,211,238,.08), rgba(167,139,250,.08));border-bottom:1px solid #1f2937}
    .chat-title{display:flex;align-items:center;gap:8px;font-weight:700}
    .dot{width:8px;height:8px;border-radius:50%;background:linear-gradient(45deg,var(--brand),var(--brand-2));box-shadow:0 0 10px var(--ring)}
    .chat-close{background:transparent;border:none;color:var(--text);font-size:20px;cursor:pointer}

    .chat-messages{flex:1;overflow:auto;padding:14px;display:flex;flex-direction:column;gap:8px;background:radial-gradient(800px 300px at 100% 0, rgba(34,211,238,.08), transparent 45%)}
    .msg{max-width:82%;padding:10px 12px;border-radius:14px;line-height:1.35;white-space:pre-wrap;word-wrap:break-word}
    .msg.user{align-self:flex-end;background:#1f2937;border:1px solid #263041}
    .msg.bot{align-self:flex-start;background:#0e1727;border:1px solid #1f2937}
    .typing{display:inline-block;min-width:22px}
    .typing span{display:inline-block;width:4px;height:4px;margin-right:3px;border-radius:50%;background:#9ca3af;animation:blink 1.2s infinite}
    .typing span:nth-child(2){animation-delay:.2s}
    .typing span:nth-child(3){animation-delay:.4s}
    @keyframes blink{ 0%,80%,100%{opacity:.2} 40%{opacity:1} }

    .chat-form{display:flex;gap:8px;padding:10px;border-top:1px solid #1f2937}
    .input{flex:1;min-height:44px;max-height:120px;resize:vertical;padding:10px 12px;border-radius:12px;border:1px solid #263041;background:#0e1727;color:var(--text);outline:none}
    .input:focus{box-shadow:0 0 0 3px var(--ring)}
    .send{padding:10px 14px;border-radius:12px;border:1px solid #1f2937;background:#121a2a;color:var(--text);cursor:pointer}
    .send[disabled]{opacity:.6;cursor:wait}
    .hint{padding:0 12px 10px;color:#9aa4b2;font-size:12px}

    @media (max-width: 720px){ .hero{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="container">
    <nav class="nav">
      <div class="logo"><span class="logo-dot"></span> Travel Demo</div>
      <div class="links">
        <a href="#">Destinations</a> · <a href="#">Itineraries</a> · <a href="#">Contact</a>
      </div>
    </nav>

    <section class="hero">
      <div>
        <h1>Explore the World Easier with <span style="background:linear-gradient(90deg,var(--brand),var(--brand-2));-webkit-background-clip:text;background-clip:text;color:transparent">AI Travel Assistant</span> (demo)</h1>
        <p>Demo website for illustration: see destination suggestions, sample itineraries, and chat with the AI chatbot in the bottom right corner.</p>
        <div class="cta">
          <button class="btn primary" onclick="openChat()">Start Chatting</button>
          <button class="btn" onclick="document.querySelector('#dest').scrollIntoView({behavior:'smooth'})">View Destinations</button>
        </div>
      </div>
      <div>
        <div class="card" style="height:100%">
          <img alt="Beautiful beach" src="images/du-lich.jpg" />
          <div class="inner">
            <span class="pill">⚡ Quick Demo</span>
            <p style="margin:10px 0 0;color:var(--muted)">No real bookings. Content is for chatbot demonstration only.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="dest" class="cards">
      <div class="card">
        <img alt="Da Nang" src="images/Cau-Rong-Da-Nang2.jpg" />
        <div class="inner"><strong>Da Nang</strong><br><span class="pill">Ba Na Hills · Dragon Bridge</span></div>
      </div>
      <div class="card">
        <img alt="Dalat" src="images/thanh-pho-da-lat.jpg" />
        <div class="inner"><strong>Dalat</strong><br><span class="pill">Cool Climate · Photo Spots</span></div>
      </div>
      <div class="card">
        <img alt="Phu Quoc" src="images/phu-quoc.jpg" />
        <div class="inner"><strong>Phu Quoc</strong><br><span class="pill">Blue Sea · Hon Thom</span></div>
      </div>
    </section>

    <footer>
      © Travel Demo 2025 · Illustration Content · No Real Services
    </footer>
  </div>

  <!-- Chat launcher -->
  <button class="chat-launcher" id="chat-launcher" aria-label="Open chatbot">Chat</button>

  <!-- Chat panel -->
  <section class="chat-panel hidden" id="chat-panel" aria-live="polite" aria-label="Travel chat window">
    <header class="chat-header">
      <div class="chat-title"><span class="dot"></span> Travel Assistant (demo)</div>
      <button class="chat-close" id="chat-close" aria-label="Close">×</button>
    </header>
    <div class="chat-messages" id="chat-messages"></div>
    <form class="chat-form" id="chat-form">
      <textarea class="input" id="chat-input" placeholder="Ask your question..." rows="1"></textarea>
      <button class="send" id="chat-send" type="submit">Send</button>
    </form>
    <div class="hint">Enter to send · Shift+Enter for new line</div>
  </section>

  <script>
    const panel = document.getElementById('chat-panel');
    const launcher = document.getElementById('chat-launcher');
    const closer = document.getElementById('chat-close');
    const messagesEl = document.getElementById('chat-messages');
    const form = document.getElementById('chat-form');
    const input = document.getElementById('chat-input');
    const sendBtn = document.getElementById('chat-send');

    const HISTORY_KEY = 'demo_chat_history_v1';
    let history = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');

    launcher.addEventListener('click', openChat);
    closer.addEventListener('click', closeChat);

    function openChat(){ panel.classList.remove('hidden'); launcher.classList.add('hidden'); input.focus(); if(messagesEl.childElementCount===0){ greet(); } }
    function closeChat(){ panel.classList.add('hidden'); launcher.classList.remove('hidden'); }

    function greet(){
      addMsg('bot', 'Hello! I\'m a travel chatbot. Try asking: "Weather in Paris?", "Best attractions in Tokyo?", or any destination name.');
    }

    function saveHistory(){ localStorage.setItem(HISTORY_KEY, JSON.stringify(history)); }

    function addMsg(role, text){
      const b = document.createElement('div');
      b.className = 'msg ' + (role === 'user' ? 'user' : 'bot');
      b.textContent = text;
      messagesEl.appendChild(b);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    function addTyping(){
      const t = document.createElement('div');
      t.className = 'msg bot';
      t.innerHTML = '<span class="typing"><span></span><span></span><span></span></span>';
      messagesEl.appendChild(t);
      messagesEl.scrollTop = messagesEl.scrollHeight;
      return t;
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const text = input.value.trim();
      if(!text) return;
      addMsg('user', text);
      history.push({ role:'user', content:text });
      saveHistory();

      input.value = '';
      input.style.height = 'auto';
      input.disabled = true; sendBtn.disabled = true;

      const typing = addTyping();
      try {
        const res = await fetch('/api/chat', {
          method:'POST', headers:{ 'Content-Type':'application/json' },
          body: JSON.stringify({ message:text, history })
        });
        const data = await res.json();
        typing.remove();
        addMsg('bot', data.reply || 'Bot cannot respond to this question.');
        history.push({ role:'assistant', content:data.reply || '' });
        saveHistory();
      } catch(err){
        typing.remove();
        addMsg('bot', 'Error calling API (demo). Please try again.');
        console.error(err);
      } finally {
        input.disabled = false; sendBtn.disabled = false; input.focus();
      }
    });

    // Tự co giãn textarea + giữ Enter để gửi
    input.addEventListener('input', () => {
      input.style.height = 'auto';
      input.style.height = Math.min(input.scrollHeight, 120) + 'px';
    });
    input.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' && !e.shiftKey){ e.preventDefault(); form.requestSubmit(); }
    });
  </script>
</body>
</html>